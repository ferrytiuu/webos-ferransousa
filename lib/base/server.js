var fs=require("fs"),Express=require("express"),http=require("http"),bodyParser=require("body-parser"),spawn=require("child_process").spawn;
(function(){var g={win32:["cmd","/c","start"],darwin:["open"],linux:["xdg-open"]},d={};"undefined"!==typeof module&&module.exports&&(module.exports=d);d.runServer=function(f,a,c,b){"function"!==typeof c||b||(b=c,c=null);f=fs.realpathSync(f);var e=new Express;e.use("/",Express["static"](f));e.use("/ares_cli",Express["static"](__dirname));e.use(bodyParser.json());e.configure(function(){c&&(e.post("/ares_cli/@@ARES_CLOSE@@",function(b,a){c("@@ARES_CLOSE@@",a)}),e.post("/ares_cli/@@GET_URL@@",function(b,
a){c("@@GET_URL@@",a)}))});var d=http.createServer(e);d.listen(a,function(a){if(a)return b(Error(a));a=d.address().port;var c="http://localhost:"+a;b(null,{msg:"Local server running on "+c,url:c,port:a})})};d.openBrowser=function(d,a,c){var b=g[process.platform];"function"===typeof a?c=a:a&&fs.existsSync(a)&&("linux"===process.platform&&b.splice(0,1),b=b.concat([a]),"darwin"===process.platform&&(b=b.concat(["--new","--args"])));this.browserProcess=spawn(b[0],b.slice(1).concat([d]));c&&c()}})();
